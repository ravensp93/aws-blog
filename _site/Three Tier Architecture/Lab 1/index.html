<!DOCTYPE html> <html lang="en" dir="auto"> <head><meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=no"> <meta name="description" content="Lab 1: VPC &amp;amp; Subnet Configuration Introduction Blueprint VPC Configuration Subnet Configuration Internet Gateway NAT Gateway Route Table Co..."> <meta name="revised" content="cb89d0ba0d0552923583d47e34b751648915100e"> <meta name="author" content="RavenSP"> <meta name="generator" content="rundocs/jekyll-rtd-theme v2.0.10"><meta name="theme-color" content="#2980b9"> <title>Lab 1: VPC &amp; Subnet Configuration 路 AWS Documentation Repository</title> <meta name="twitter:title" content="Lab 1: VPC &amp; Subnet Configuration 路 AWS Documentation Repository"> <meta name="twitter:description" content="Lab 1: VPC &amp;amp; Subnet Configuration Introduction Blueprint VPC Configuration Subnet Configuration Internet Gateway NAT Gateway Route Table Co..."> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@RavenSP"> <meta name="twitter:url" content="http://localhost:4000/Three%20Tier%20Architecture/Lab%201/"> <meta name="twitter:creator" content="@rundocs/jekyll-rtd-theme v2.0.10"> <meta property="og:title" content="Lab 1: VPC &amp; Subnet Configuration 路 AWS Documentation Repository"> <meta property="og:description" content="Lab 1: VPC &amp;amp; Subnet Configuration Introduction Blueprint VPC Configuration Subnet Configuration Internet Gateway NAT Gateway Route Table Co..."> <meta property="og:locale" content="en"> <meta property="og:url" content="http://localhost:4000/Three%20Tier%20Architecture/Lab%201/"> <meta property="og:type" content="article"> <meta property="article:author" content="RavenSP"> <meta property="article:published_time" content="2020-12-11T02:59:42+08:00"> <meta property="article:modified_time" content="2020-12-11T04:33:47+08:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Article", "mainEntityOfPage": { "@type": "WebPage", "@id": "http://localhost:4000/Three%20Tier%20Architecture/Lab%201/" }, "headline": "Lab 1: VPC &amp; Subnet Configuration 路 AWS Documentation Repository", "image": [], "author": { "@type": "Person", "name": "RavenSP" }, "datePublished": "2020-12-11T02:59:42+08:00", "dateModified": "2020-12-11T04:33:47+08:00", "publisher": { "@type": "User", "name": "RavenSP", "logo": { "@type": "ImageObject", "url": "https://avatars1.githubusercontent.com/u/66004820?v=4" } }, "description": "Lab 1: VPC &amp;amp; Subnet Configuration Introduction Blueprint VPC Configuration Subnet Configuration Internet Gateway NAT Gateway Route Table Co..." } </script> <link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="canonical" href="http://localhost:4000/Three%20Tier%20Architecture/Lab%201/"><link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg"><link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/assets/images/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96"><link rel="mask-icon" href="/assets/images/favicon.svg" color="#2980b9"><link rel="apple-touch-icon" href="/assets/images/apple-touch-icon-300x300.jpg"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/css/theme.min.css"><script> window.ui = { title: "AWS Documentation Repository", baseurl: "", i18n: { search_results: "Search Results", search_results_found: "Search finished, found # page(s) matching the search query.", search_results_not_found: "Your search did not match any documents, please make sure that all characters are spelled correctly!" } }; </script> </head> <body class="container"><div class="sidebar-wrap overflow-hidden"> <div class="sidebar height-full overflow-y-scroll overflow-x-hidden"> <div class="header d-flex flex-column p-3 text-center"> <div class="title pb-1"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/" title="A Repository for AWS POCs and Labs"> <i class="fa fa-home"></i> AWS Documentation Repository </a> </div> <span class="version"></span> <form class="search pt-2" action="/search.html" method="get" autocomplete="off"> <input class="form-control input-block input-sm" type="text" name="q" placeholder="Search docs..."> </form> </div> <div class="toctree py-2" data-spy="affix" role="navigation" aria-label="main navigation"> <ul> </ul> <a class="caption d-block text-uppercase no-wrap px-2 py-0" href="/Three%20Tier%20Architecture/"> Three-Tier Infrastructure Setup </a><ul> <li class="toc level-1"> <a class="d-flex flex-items-baseline" href="/Three%20Tier%20Architecture/Lab%201/"> Lab 1: VPC &amp; Subnet Configuration </a><ul> </ul> </li> <li class="toc level-1"> <a class="d-flex flex-items-baseline" href="/Three%20Tier%20Architecture/Lab%202/"> Lab 2: Bastion Host Configuration </a><ul> </ul> </li></ul> <a class="caption d-block text-uppercase no-wrap px-2 py-0" href="/2nd%20Page/"> Second Page TBA </a><ul> </ul> </div> </div> </div> <div class="content-wrap"> <div class="header d-flex flex-justify-between p-2 hide-lg hide-xl" aria-label="top navigation"> <button id="toggle" aria-label="Toggle menu" class="btn-octicon p-2 m-0 text-white" type="button"> <i class="fa fa-bars"></i> </button> <div class="title flex-1 d-flex flex-justify-center"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/">AWS Documentation Repository</a> </div> </div> <div class="content p-3 p-sm-5"> <div class="navigation-top d-flex flex-justify-between"> <ul class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation"> <li class="breadcrumb-item"> <a class="no-underline" href="/" title="/"> <i class="fa fa-home"></i> </a> </li><li class="breadcrumb-item" ><a href="/Three Tier Architecture/">Three Tier Architecture</a></li><li class="breadcrumb-item" ><a href="/Three Tier Architecture/Lab 1/">Lab 1</a></li><li class="breadcrumb-item" aria-current="page">readme.md</li></ul> <a class="edit" href="https://github.com/ravensp93/aws-blog/edit/gh-pages/Three%20Tier%20Architecture/Lab%201/readme.md" title="Edit on GitHub" rel="noreferrer" target="_blank"> <i class="fa fa-edit"></i> </a> </div> <hr> <div role="main" itemscope="itemscope" itemtype="https://schema.org/Article"> <div class="markdown-body" itemprop="articleBody"> <h1 id="lab-1-vpc--subnet-configuration">Lab 1: VPC &amp; Subnet Configuration</h1> <ul> <li><a href="#introduction">Introduction</a></li> <li><a href="#blueprint">Blueprint</a></li> <li><a href="#vpc-configuration">VPC Configuration</a></li> <li><a href="#subnet-configuration">Subnet Configuration</a></li> <li><a href="#internet-gateway">Internet Gateway</a></li> <li><a href="#nat-gateway">NAT Gateway</a></li> <li><a href="#route-table-configuration">Route Table Configuration</a></li> </ul> <h2 id="introduction">Introduction</h2> <p>In this lab, we will configure a VPC network hosting public and private subnet on different availability zones. Enable access to the internet for subnets via route tables and aws gateway resources</p> <h2 id="blueprint">Blueprint</h2> <p align="center"> <img src="blob/lab-1-vpc-subnet-arch.PNG" /> </p> <h2 id="vpc-configuration">VPC Configuration</h2> <p>1) In <strong>VPC</strong> service page, navigate to <strong>Your VPCs</strong> page and click on <strong>Create VPC</strong><br /> 2) Tag VPC resource with a <strong>name</strong> 3-tier-vpc<br /> 3) set <strong>IPv4 CIDR block IP</strong> to <strong>10.0.0.0/16</strong><br /> 4) Click <strong>Create VPC</strong></p> <p align="center"> <img src="blob/lab-1-pic-1.PNG" /> </p> <h3 id="dns-hostname-assignment">DNS Hostname assignment</h3> <p>By enabling <strong>DNS Hostnames</strong>, EC2 Instances created with public IP within this VPC will automatically be assigned a hostname.</p> <p>5) Right click the created VPC, Click on <strong>Edit DNS Hostnames</strong></p> <p align="center"> <img src="blob/lab-1-pic-2.PNG" /> </p> <p>6) Click <strong>Enable</strong> Checkbox and save the changes.</p> <p align="center"> <img src="blob/lab-1-pic-3.PNG" /> </p> <p>7) <strong>Enable DNS Hostname assignment for both PUBLIC subnets</strong></p> <h2 id="subnet-configuration">Subnet Configuration</h2> <p>Create subnets to segregate resources into public and private zones. Subnets will be created in two different availability zones for high availability.</p> <table> <thead> <tr> <th>Name Tag</th> <th>IPv4 CIDR</th> <th>Availability Zone</th> </tr> </thead> <tbody> <tr> <td>private-subnet-1</td> <td>10.0.0.0/24</td> <td>ap-southeast-1a</td> </tr> <tr> <td>private-subnet-2</td> <td>10.0.1.0/24</td> <td>ap-southeast-1b</td> </tr> <tr> <td>public-subnet-1</td> <td>10.0.2.0/24</td> <td>ap-southeast-1a</td> </tr> <tr> <td>public-subnet-2</td> <td>10.0.3.0/24</td> <td>ap-southeast-1b</td> </tr> </tbody> </table> <p>1) In <strong>VPC</strong> service page, navigate to <strong>Subnets</strong> page and click on <strong>Create subnet</strong></p> <p align="center"> <img src="blob/lab-1-pic-4.PNG" /> </p> <p>2) Tag Subnet with a <strong>name: private-subnet-1</strong><br /> 3) Select <strong>VPC:</strong> 3-tier-vpc<br /> 4) Select <strong>Availability Zone</strong> ap-southeast-1a<br /> 5) set <strong>IPv4 CIDR block IP</strong> to <strong>10.0.0.0/24</strong><br /> 6) Click <strong>Create</strong></p> <p align="center"> <img src="blob/lab-1-pic-5.PNG" /> </p> <p>7) Create the other three subnets</p> <p align="center"> <img src="blob/lab-1-pic-6.PNG" /> </p> <p><strong>Reserved Addresses for Subnets:</strong></p> <ul> <li>10.0.0.0 Network Address</li> <li>10.0.0.1 Reserved by AWS for the VPC router</li> <li>10.0.0.2 Reserved by AWS</li> <li>10.0.0.3: Reserved by AWS for future use</li> <li>10.0.0.255: Network broadcast address, but not supported by AWS in a VPC</li> </ul> <h2 id="internet-gateway">Internet Gateway</h2> <p>Internet Gateway allows internet access to your VPC</p> <p>1) In <strong>VPC</strong> service page, navigate to <strong>Internet Gateways</strong> page and click on <strong>Create internet gateway</strong></p> <p align="center"> <img src="blob/lab-1-pic-10.PNG" /> </p> <p>2) <strong>Optional</strong> Tag Internet Gateway with a <strong>name</strong> 3) Click <strong>Create Internet gateway</strong></p> <p align="center"> <img src="blob/lab-1-pic-11.PNG" /> </p> <p>4) Right-click the created Internet gateway and click on <strong>Attach to VPC</strong></p> <p align="center"> <img src="blob/lab-1-pic-12.PNG" /> </p> <p>5) Select <strong>Available VPC</strong> to attach to 3-tier-vpc<br /> 6) Click on <strong>Attach Internet Gateway</strong></p> <p align="center"> <img src="blob/lab-1-pic-13.PNG" /> </p> <h2 id="nat-gateway">NAT gateway</h2> <p><strong>Pre requisite: After route to internet has been configured for public subnet</strong></p> <p>NAT gateway enable instances in a private subnet to connect to the internet or other AWS service, but prevent the internet from initiating a connection with those instances</p> <p>1) In <strong>VPC</strong> service page, navigate to <strong>NAT Gateways</strong> page and click on <strong>Create NAT gateway</strong></p> <p align="center"> <img src="blob/lab-1-pic-7.PNG" /> </p> <p>2) <strong>Optional</strong> Tag NAT Gateway with a <strong>name</strong> <br /> 3) Select <strong>subnet:</strong> public-subnet-2. Selection can be either of the <strong>Public</strong> subnets<br /> 4) Select an <strong>existing Elastic IP</strong> or click on <strong>allocate Elastic IP</strong><br /> 5) Click <strong>Create NAT gateway</strong></p> <p align="center"> <img src="blob/lab-1-pic-8.PNG" /> </p> <h2 id="route-table-configuration">Route Table Configuration</h2> <p>Using routing tables assign to subnets, allow public and private subnets to have internet access through the VPC's Internet gateway and the NAT gateway in the public subnet</p> <table> <thead> <tr> <th>Name Tag</th> <th>Route Configuration</th> </tr> </thead> <tbody> <tr> <td>3-tier-pub-rt</td> <td>Route public subnets to access internet via Internet Gateway</td> </tr> <tr> <td>3-tier-priv-rt</td> <td>Route private subnets to access internet via NAT Gateway</td> </tr> </tbody> </table> <p>1) In <strong>VPC</strong> service page, navigate to <strong>Route Tables</strong> page and click on <strong>Create route table</strong></p> <ul> <li>A <strong>main</strong> Default Route table is created for every VPC. All subnet without assigned route tables will be assigned to the main default route table.</li> </ul> <p align="center"> <img src="blob/lab-1-pic-9.PNG" /> </p> <p>2) <strong>Optional</strong> Tag route table with a <strong>name: 3-tier-pub-rt</strong>\ 3) Select <strong>VPC:</strong> &lt;3-tier-vpc&gt;<br /> 4) Click on <strong>Create</strong><br /> 5) Create route table for <strong>public subnet</strong></p> <p align="center"> <img src="blob/lab-1-pic-15.PNG" /> </p> <h3 id="route-creation">Route Creation</h3> <p>6) Right-click on <strong>3-tier-pub-rt</strong>, Click <strong>Edit routes</strong></p> <p align="center"> <img src="blob/lab-1-pic-16.PNG" /> </p> <p>7) Click <strong>Add route</strong><br /> 8) Set <strong>Destination</strong> to <strong>0.0.0.0/0</strong>, <strong>Target: Internet Gateway</strong>\ 9) Click <strong>Save routes</strong></p> <p align="center"> <img src="blob/lab-1-pic-17.PNG" /> </p> <p>10) Right click on <strong>3-tier-pub-rt</strong>, select <strong>Edit subnet associations</strong></p> <p align="center"> <img src="blob/lab-1-pic-19.PNG" /> </p> <p>11) Select both the <strong>public subnets</strong> 12) Click <strong>Save</strong></p> <p align="center"> <img src="blob/lab-1-pic-20.PNG" /> </p> <p><strong>Pre requisite: After NAT Gateway has been configured for public subnet</strong><br /> 13) Edit route for <strong>3-tier-priv-rt</strong><br /> 14) Click <strong>Add route</strong><br /> 15) Set <strong>Destination</strong> to <strong>0.0.0.0/0</strong>, <strong>Target: NAT Gateway</strong><br /> 16) Click <strong>Save routes</strong></p> <p align="center"> <img src="blob/lab-1-pic-18.PNG" /> </p> <p>17) Associate <strong>Route Table: 3-tier-priv-rt</strong> to both private subnets</p> <p align="center"> <img src="blob/lab-1-pic-21.PNG" /> </p> </div> </div> <hr> <div class="copyright text-center text-gray" role="contentinfo"> <i class="fa fa-copyright"></i> <span class="time">2020,</span> <a class="text-gray" href="https://github.com/ravensp93" rel="noreferrer" target="_blank">RavenSP</a> Revision <a class="text-gray" href="https://github.com/ravensp93/aws-blog/commit/cb89d0ba0d0552923583d47e34b751648915100e" title="cb89d0ba0d0552923583d47e34b751648915100e" rel="noreferrer" target="_blank">cb89d0b</a> <br> <div class="generator"> Built with <a href="https://pages.github.com" rel="noreferrer" target="_blank" title="github-pages v209">GitHub Pages</a> using a <a href="https://github.com/rundocs/jekyll-rtd-theme" rel="noreferrer" target="_blank" title="rundocs/jekyll-rtd-theme v2.0.10">theme</a> provided by <a href="https://rundocs.io" rel="noreferrer" target="_blank">RunDocs</a>. </div> </div> </div> </div> <div class="addons-wrap d-flex flex-column overflow-y-auto"> <div class="status d-flex flex-justify-between p-2"> <div class="title p-1"> <i class="fa fa-book"></i> AWS Documentation Repository </div> <div class="branch p-1"> <span class="name"> gh-pages </span> <i class="fa fa-caret-down"></i> </div> </div> <div class="addons d-flex flex-column height-full p-2 d-none"> <dl> <dt>GitHub</dt> <dd> <a href="https://github.com/ravensp93/aws-blog" title="Stars: 0"> <i class="fa fa-github"></i> Homepage </a> </dd> <dd> <a href="https://github.com/ravensp93/aws-blog/issues" title="Open issues: 0"> <i class="fa fa-question-circle-o"></i> Issues </a> </dd> <dd> <a href="https://github.com/ravensp93/aws-blog/zipball/gh-pages" title="Size: 5141 Kb"> <i class="fa fa-download"></i> Download </a> </dd> </dl> <hr> <div class="license f6 pb-2"> This <a href="/" title="AWS Documentation Repository">Software</a> is under the terms of <a href="https://github.com/ravensp93/aws-blog">The Unlicense</a>. </div> </div> </div> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/theme.min.js"></script> </body> </html>